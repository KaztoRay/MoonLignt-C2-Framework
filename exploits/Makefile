# Moonlight C2 Framework - Exploits Makefile
# For Windows with MinGW or Microsoft Visual C++

CC = gcc
CFLAGS = -Wall -O2 -DWIN32 -D_WIN32_WINNT=0x0500
LDFLAGS = -lws2_32 -ladvapi32 -lwinspool -luser32 -lntdll
TARGETS = ms08-067.exe ms03-026.exe ms17-010.exe ms03-039.exe ms05-039.exe \
          ms06-040.exe ms09-050.exe ms08-025.exe ms10-015.exe ms11-046.exe \
          ms10-061.exe ms12-020.exe ie-ani-exploit.exe ie-activex-exploit.exe \
          ms06-014.exe
SOURCES = ms08_067.c ms03_026.c ms17_010.c ms03_039.c ms05_039.c ms06_040.c \
          ms09_050.c ms08_025.c ms10_015.c ms11_046.c ms10_061.c ms12_020.c \
          ie_ani_exploit.c ie_activex_exploit.c ms06_014.c

.PHONY: all clean

all: $(TARGETS)
	@echo [+] All exploits built successfully

ms08-067.exe: ms08_067.c
	$(CC) $(CFLAGS) $< -o $@ $(LDFLAGS)
	@echo [+] Built MS08-067 exploit

ms03-026.exe: ms03_026.c
	$(CC) $(CFLAGS) $< -o $@ $(LDFLAGS)
	@echo [+] Built MS03-026 exploit

ms17-010.exe: ms17_010.c
	$(CC) $(CFLAGS) $< -o $@ $(LDFLAGS)
	@echo [+] Built MS17-010 EternalBlue exploit

ms03-039.exe: ms03_039.c
	$(CC) $(CFLAGS) $< -o $@ $(LDFLAGS)
	@echo [+] Built MS03-039 RPC DCOM exploit

ms05-039.exe: ms05_039.c
	$(CC) $(CFLAGS) $< -o $@ $(LDFLAGS)
	@echo [+] Built MS05-039 Plug and Play exploit

ms06-040.exe: ms06_040.c
	$(CC) $(CFLAGS) $< -o $@ $(LDFLAGS)
	@echo [+] Built MS06-040 Server Service exploit

ms09-050.exe: ms09_050.c
	$(CC) $(CFLAGS) $< -o $@ $(LDFLAGS)
	@echo [+] Built MS09-050 SMBv2 exploit

ms08-025.exe: ms08_025.c
	$(CC) $(CFLAGS) $< -o $@ $(LDFLAGS)
	@echo [+] Built MS08-025 kernel privilege escalation

ms10-015.exe: ms10_015.c
	$(CC) $(CFLAGS) $< -o $@ $(LDFLAGS)
	@echo [+] Built MS10-015 KiTrap0D exploit

ms11-046.exe: ms11_046.c
	$(CC) $(CFLAGS) $< -o $@ $(LDFLAGS)
	@echo [+] Built MS11-046 AFD.sys exploit

ms10-061.exe: ms10_061.c
	$(CC) $(CFLAGS) $< -o $@ $(LDFLAGS)
	@echo [+] Built MS10-061 Print Spooler exploit

ms12-020.exe: ms12_020.c
	$(CC) $(CFLAGS) $< -o $@ $(LDFLAGS)
	@echo [+] Built MS12-020 RDP exploit

ie-ani-exploit.exe: ie_ani_exploit.c
	$(CC) $(CFLAGS) $< -o $@
	@echo [+] Built IE ANI file exploit generator

ie-activex-exploit.exe: ie_activex_exploit.c
	$(CC) $(CFLAGS) $< -o $@
	@echo [+] Built IE ActiveX exploit generator

ms06-014.exe: ms06_014.c
	$(CC) $(CFLAGS) $< -o $@ $(LDFLAGS)
	@echo [+] Built MS06-014 MDAC exploit

clean:
	del /Q *.exe 2>nul || echo Cleaned

install:
	@echo [*] Installing exploits to ../bin/exploits/
	@if not exist "..\bin\exploits" mkdir "..\bin\exploits"
	copy *.exe ..\bin\exploits\
